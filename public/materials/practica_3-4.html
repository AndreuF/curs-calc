<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ca" lang="ca" dir="ltr">

<!-- Generat el 28/Mar/2012  14:47:27  amb HTTrack -->
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    UF4. Fulls de càlcul
  </title>

  <link rel="stylesheet" media="all" type="text/css" href="css/cssff6e.css?s=all&amp;t=estatic" />
<link rel="stylesheet" media="screen" type="text/css" href="css/css6139.css?t=estatic" />
<link rel="stylesheet" media="print" type="text/css" href="css/css6f71.css?s=print&amp;t=estatic" /><link rel="stylesheet" media="all" type="text/css" href="css/mystyle.css" />

  <link rel="shortcut icon" href="ico/favicon.ico" />


  <!--<script type="text/javascript" src="http://ateneu.xtec.cat/dades/wikiform/html/MathJax/MathJax.js"></script>-->


</head>



<body>




<div class="dokuwiki">


<div class="headermain"><!--<a href="http://ateneu.xtec.cat/wikiform/wikiexport"><span class="logoateneu"></span></a>--><div class="titol">UF4. Fulls de càlcul </div><div class="subtitol"> Pràctica 4 - Exercici 3</div></div><div class="navega"><div id="navcontainer"><ul id="navlist"><li><a href="index.html" title="Inici">&lt;&lt;</a></li>  <li><a href="index-5.html"><</a></li>  <li><a href="practica_1-4.html">Exercici 1</a></li>  <li><a href="practica_2-4.html">Exercici 2</a></li>  <li id="active"><a id="current" href="#">Exercici 3</a></li>  <li><a href="practica_4-4.html">Exercici 4</a></li>  <li><a href="practica_5-4.html">Exercici 5</a></li>  <li><a href="practica_6-4.html">Exercici 6</a></li>  <li><a href="practica_7.html">Exercici 7</a></li>  <li><a href="practica_8.html">Exercici 8</a></li>  <li><a href="practica_9.html">Exercici 9</a></li></ul></div></div>


  <div class="page">

    <!-- ......... wikipage start ......... -->

<h1><a name="escriure_numeros_amb_lletra" id="escriure_numeros_amb_lletra">Escriure números amb lletra</a></h1>
<div class="level1">

<p>

<strong>Presentació gràfica de l&#039;activitat.</strong><br/>

<img src="png/escriure_numeros_amb_lletra.png" class="media" alt="" /><br/>

<br/>

<strong>Funcions que es fan servir en aquesta activitat</strong><br/>

</p>
<ul>
<li class="level1"><div class="li"><a href="funcions.html#aleatentre" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=ALEAENTRE()</a></div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#si" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=SI()</a></div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#long" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=LONG()</a></div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#mig" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=MIG()</a></div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#valor" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=VALOR()</a></div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#consulta" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=CONSULTA()</a></div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#retalla" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=RETALLA()</a></div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#substitueix" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=SUBSTITUEIX()</a></div>
</li>
<li class="level1"><div class="li">Operador de text &amp;</div>
</li>
</ul>

<p>
<br/>

<strong>Objectiu de l&#039;activitat</strong><br/>

Es tracta d&#039;escriure amb lletra a la cel·la de color gris el número que hi ha a la cel·la <strong>B5</strong>. En fer clic a la macro, es presenta un nou número i s&#039;esborra el que hi ha escrit a la cel·la <strong>C5</strong>. El número aleatori que hi ha a la cel·la <strong>B5</strong> està entre el <strong>0</strong> i el <strong>999.999</strong>.<br/>

<br/>

<strong>Desenvolupament de l&#039;activitat:</strong><br/>

<strong>1</strong>. Obrir el fitxer <strong>M4</strong> i afegir un nou full amb el nom de <strong>M4P3 escriure números amb lletra</strong>.<br/>

<strong>2</strong>. Escriure a la cel·la <strong>B5</strong>: <strong>=SI(A1=0;ALEATENTRE(0;999999))</strong><br/>

<strong>3</strong>. Assignar els següents atributs a la cel·la <strong>C5</strong>:<br/>

</p>
<ul>
<li class="level1"><div class="li">tipus de lletra: arial</div>
</li>
<li class="level1"><div class="li">tipografia: normal</div>
</li>
<li class="level1"><div class="li">mida: 14</div>
</li>
<li class="level1"><div class="li">color de fons: taronja 4</div>
</li>
</ul>

<p>
<strong>4</strong>. Escriure a la cel·la <strong>F5</strong>: <strong>=B5</strong><br/>

<strong>5</strong>. Escriure a la cel·la <strong>F4</strong>: <strong>=LONG(F5)</strong><br/>

<div class="noteclassic">Amb la fórmula <strong>=LONG(F5)</strong> es compta el número de caràcters de la cel·la <strong>F5</strong>, que són el número de dígits del número que es mostra a la cel·la <strong>B5</strong>.
</div><br/>

<strong>6</strong>. Escriure a la cel·la <strong>H5</strong>: <strong>=SI(F4&lt;6;&quot;&quot;;VALOR(MIG(F5;F4-5;1)))</strong>.
<div class="noteclassic">La fórmula <strong>=SI(F4&lt;6;&quot;&quot;;VALOR(MIG(F5;F4-5;1)))</strong> significa el següent:<br/>

<br/>

En cas que el valor de <strong>F4</strong> sigui menor que <strong>6</strong>, llavors el contingut de la cel·la serà buit; si no, extreu de la cel·la <strong>F5</strong> el caràcter definit per la fórmula <strong>VALOR(MIG(F5;F4-5;1)</strong>.<br/>

<br/>

L&#039;<strong>F5</strong> és el text de qual s&#039;han de determinar les paraules parcials (contingut de la cel·la <strong>F5</strong>).<br/>

<br/>

L&#039;<strong>F4-5</strong> és la posició des de la qual s&#039;ha de determinar la paraula inicial (que en realitat és un número). En cas que el número que apareix a la cel·la <strong>F4</strong> sigui el <strong>6</strong>, llavors <strong>F4</strong> menys <strong>5</strong> serà <strong>1</strong> per la qual cosa la posició d&#039;inici serà el primer caràcter començant per l&#039;esquerra.<br/>

<br/>

L&#039;<strong>1</strong> és el nombre de caràcters que cal extreure partint de la posició inicial <strong>F4-5</strong>. En cas que el número que apareix a la cel·la <strong>F4</strong> sigui el <strong>6</strong>, s&#039;extrauria el valor de la centena de miler.<br/>

<br/>

<strong>VALOR</strong> converteix el text en un número.
</div><br/>

<br/>

<strong>7</strong>. Escriure a la cel·la <strong>I5</strong>:<strong> =SI(F4&lt;5;&quot;&quot;;VALOR(MIG(F5;F4-4;1)))</strong><br/>

<strong>8</strong>. Escriure a la cel·la <strong>J5</strong>: <strong>=SI(F4&lt;4;&quot;&quot;;VALOR(MIG(F5;F4-3;1)))</strong><br/>

<strong>9</strong>. Escriure a la cel·la <strong>K5</strong>: <strong>=SI(F4&lt;3;&quot;&quot;;VALOR(MIG(F5;F4-2;1)))</strong><br/>

<strong>10</strong>. Escriure a la cel·la <strong>L5</strong>: <strong>=SI(F4&lt;2;&quot;&quot;;VALOR(MIG(F5;F4-1;1)))</strong><br/>

<strong>11</strong>. Escriure a la cel·la <strong>M5</strong>:<strong> =VALOR(MIG(F5;F4;1))</strong><br/>

<div class="noteclassic">Els passos <strong>7</strong>, <strong>8</strong>, <strong>9</strong>, <strong>10</strong> i <strong>11</strong> segueixen la mateixa dinàmica que l&#039;explicat en la nota del pas <strong>6</strong>.
</div><br/>

<div class="noteclassic">Amb el passos del <strong>6</strong> a l&#039;<strong>11</strong> s&#039;obté la unitat (<strong>M5</strong>), la desena (<strong>L5</strong>), la centena (<strong>k5</strong>), la unitat de miler (<strong>J5</strong>), la desena de milers (<strong>I5</strong>) i la centena de miler del número que hi ha a la cel·la <strong>B10</strong>
</div>
<strong>12</strong>. Escriure a la cel·la <strong>I6</strong>: <strong>=SI(I(I5=&quot;&quot;;J5=&quot;&quot;);&quot;&quot;;VALOR(I5&amp;J5))</strong><br/>

<strong>13</strong>. Connectar les cel·les<strong> I6 i J6</strong><br/>

<strong>14</strong>. Escriure al rang de les ce·les <strong>H10:H18</strong> els números del <strong>1</strong> al <strong>9</strong><br/>

<strong>15</strong>. Escriure en lletra al rang de les cel·les <strong>I10:I18</strong> el següent:<br/>

</p>
<ul>
<li class="level1"><div class="li">I10: cent</div>
</li>
<li class="level1"><div class="li">I11: dos-cents</div>
</li>
<li class="level1"><div class="li">I12: tres-cents</div>
</li>
<li class="level1"><div class="li">I13: quatre-cents</div>
</li>
<li class="level1"><div class="li">I14: cinc-cents</div>
</li>
<li class="level1"><div class="li">I15: sis-cents</div>
</li>
<li class="level1"><div class="li">I16: set-cents</div>
</li>
<li class="level1"><div class="li">I17: vuit-cents</div>
</li>
<li class="level1"><div class="li">I18: nou-cents</div>
</li>
</ul>

<p>
<strong>16</strong>. Escriure al rang de les cel·les <strong>J10:J109</strong> els números de <strong>0</strong> al <strong>99</strong><br/>

<strong>17</strong>. Escriure al rang de les cel·les <strong>K9:k109</strong> els números amb lletra corresponents al rang <strong>J10:J109</strong><br/>

<strong>18</strong>. Escriure a la cel·la <strong>H7</strong>: <strong>=SI(H5=””;””;CONSULTA(H5;H9:H18;I9:I18))</strong><br/>

<div class="noteclassic">Amb aquesta fórmula si <strong>H5</strong> mostra algun valor, s’obté la centena de miler fent-se la corresponent consulta; si no, no mostra cap valor.
</div><br/>

</p>

<p>
<strong>19</strong>. Escriure a la cel·la <strong>I7:</strong><br/>

<strong>=SI(I6=&quot;&quot;;&quot;&quot;;SI(I6=1;&quot;un mil&quot;;SI(I6=0;&quot; mil&quot;;CONSULTA(I6;J9:J109;K9:K109)&amp;&quot; mil&quot;)))</strong><br/>

<div class="noteclassic">Amb aquesta fórmula si la cel·la <strong>I6</strong> mostra el valor de <strong>1</strong>, retorna la paraula <strong>“mil”</strong>; si és un valor diferent de <strong>1</strong>, es fa la corresponent consulta concatenant la paraula mil. Observar l’espai que hi ha abans de la lletra <strong>m</strong> de <strong>” mil”</strong>.
</div><br/>

<strong>20</strong>. Escriure a la cel·la <strong>k7: =SI(K5=&quot;&quot;;&quot;&quot;;SI(K5=0;&quot;&quot;;CONSULTA(K5;H9:H18;I9:I18)))</strong><br/>

<strong>21</strong>. Escriure a la cel·la <strong>L6</strong>: <strong>=VALOR(L5&amp;M5)</strong><br/>

<strong>22</strong>. Connectar les cel·les <strong>L6</strong> i <strong>M6</strong>.<br/>

<div class="noteclassic">D’aquesta manera s’obté un número que representa la desena o la unitat del
número que hi ha a la cel·la <strong>B5</strong>
</div><br/>

<strong>23</strong>. Escriure a la cel·la <strong>L7</strong>:
<strong>=SI(I(L5=0;M5=0);&quot;&quot;;SI(VALOR(H5&amp;I5&amp;J5&amp;K5&amp;L5&amp;M5)=0;&quot;zero&quot;;CONSULTA(L6;J10:
J109;K10:K109)))</strong><br/>

<div class="noteclassic">Amb <strong>SI(I(L5=0;M5=0)</strong> s&#039;aconsegueix que es retorni l&#039;expressió de <strong>“X cents”</strong> sempre que la <strong>X</strong> sigui major que <strong>1</strong> o l&#039;expressió <strong>“cent”</strong> en cas que la <strong>X</strong> sigui <strong>1</strong>.
</div><br/>

<strong>24</strong>. Escriure a la cel·la <strong>G5</strong>: <strong>=RETALLA(H7&amp;” ”&amp;I7&amp;” ”&amp;K7&amp;” ”&amp;L7)</strong><br/>

<div class="noteclassic">La funció <strong>RETALLA</strong> elimina del text els espais extres. D’aquesta manera s’obté en lletra el número que apareix a la cel·la <strong>B5</strong>.
</div><br/>

El passos que venen a continuació, del <strong>25</strong> al <strong>29</strong>, serveixen per a donar opció a escriure els números en masculí o en femení.<br/>

<strong>25</strong>. Escriure a la cel·la <strong>G6</strong>: <strong>=SUBSTITUEIX(G5;&quot;cents&quot;;&quot;centes&quot;)</strong><br/>

<strong>26</strong>. Escriure a la cel·la <strong>G7</strong>: <strong>=SUBSTITUEIX(G6;&quot;dos&quot;;&quot;dues&quot;)</strong><br/>

<strong>27</strong>. Escriure a la cel·la <strong>G8</strong>: <strong>=SUBSTITUEIX(G7;&quot;un&quot;;&quot;una&quot;)</strong><br/>

<strong>28</strong>. Escriure a la cel·la <strong>G9</strong>: <strong>=SUBSTITUEIX(G5;&quot;un&quot;;&quot;u&quot;)</strong><br/>

<strong>29</strong>. Escriure a la cel·la <strong>D5</strong>: <strong>=SI(C5=&quot;&quot;;&quot;&quot;;SI(O(C5=G5;C5=G8;C5=G9);&quot;bé&quot;;&quot;no&quot;))</strong><br/>

<div class="noteclassic">Amb aquesta fórmula s’avalua l’escrit a la cel·la <strong>C5</strong> si aquesta mostra algun valor. Si el que s’ha escrit a la cel·la <strong>C5</strong> és igual a qualsevol de les cel·les <strong>G5</strong>, <strong>G8</strong> o <strong>G9</strong>, llavors apareix l’avaluador “bé”; si no, apareix el “no”.
</div><br/>

<strong>30</strong>. Fer una macro amb les següent funcions:<br/>

• Esborrar el contingut de la cel·la <strong>C5</strong><br/>

• Assignar a la cel·la <strong>A1</strong> el valor de <strong>0</strong><br/>

• Que la cel·la <strong>C5</strong> rebi el focus.<br/>

<strong>31</strong>. Crear un botó (comandament) de Controls de formulari i assignar-li la macro feta anteriorment.<br/>

<strong>32</strong>. Validar la cel·la <strong>A1</strong> per al valor <strong>0</strong>.<br/>

<strong>33</strong>. Protegir les cel·les que convingui.<br/>

<strong>34</strong>. Fer no visibles les cel·les que convingui.<br/>

<strong>35</strong>. Comprovar que l’activitat funcioni correctament.<br/>

<strong>36</strong>. Desar el fitxer <strong>M4</strong>.

</p>

</div>

    <!-- ......... wikipage stop  ......... -->

  </div>

  <div class="clearer">&nbsp;</div>


<br /><br />
  
 <div class="footerinc">
  <hr />
  <table style="width: 100%;">
  <tr style="vertical-align: middle;">
    <td  style="width: 18%; ">
      <div style="float: left;">
      <!--<a target="_blank" href="http://ateneu.xtec.cat/wikiform" title="Materials i recursos per a la formació"><img src="png/ateneu2.png" width="91" height="30" alt="Materials i recursos per a la formació" /></a>-->
      </div>
    </td>
    <td style="width: 32%;">
      
    </td>
    <td style="width: 32%;">

      <!--      <a target="_blank"href="http://www.dokuwiki.org/" target="_blank" title="DokuWiki"><img src="png/button-dw.png" width="80" height="15" alt="DokuWiki" /></a>-->

    </td>
	<td style="width: 18%;">
      <div style="float: right;">
      
      </div>
    </td>
  </tr>
  </table>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>
-->
</div>

</div>

</body>

<!-- Generat el 28/Mar/2012  14:47:27  amb HTTrack -->
</html>
