<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ca" lang="ca" dir="ltr">

<!-- Generat el 28/Mar/2012  14:47:27  amb HTTrack -->
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
    UF4. Fulls de càlcul
  </title>

  <link rel="stylesheet" media="all" type="text/css" href="css/cssff6e.css?s=all&amp;t=estatic" />
<link rel="stylesheet" media="screen" type="text/css" href="css/css6139.css?t=estatic" />
<link rel="stylesheet" media="print" type="text/css" href="css/css6f71.css?s=print&amp;t=estatic" /><link rel="stylesheet" media="all" type="text/css" href="css/mystyle.css" />

  <link rel="shortcut icon" href="ico/favicon.ico" />


  <!--<script type="text/javascript" src="http://ateneu.xtec.cat/dades/wikiform/html/MathJax/MathJax.js"></script>-->


</head>



<body>



<div class="dokuwiki">


<div class="headermain"><!--<a href="http://ateneu.xtec.cat/wikiform/wikiexport"><span class="logoateneu"></span></a>--><div class="titol">UF4. Fulls de càlcul </div><div class="subtitol"> Pràctica 6 - Pr&agrave;c. 2</div></div><div class="navega"><div id="navcontainer"><ul id="navlist"><li><a href="index.html" title="Inici">&lt;&lt;</a></li>  <li><a href="index-7.html"><</a></li>  <li><a href="practica_1-6.html">Pr&agrave;c. 1</a></li>  <li id="active"><a id="current" href="#">Pr&agrave;c. 2</a></li>  <li><a href="practica_3-6.html">Pr&agrave;c. 3</a></li>  <li><a href="practica_4-6.html">Pr&agrave;c. 4</a></li>  <li><a href="practica_5-6.html">Pr&agrave;c. 5</a></li>  <li><a href="practica_6-6.html">Pr&agrave;c. 6</a></li>  <li><a href="practica_7-3.html">Pr&agrave;c. 7</a></li>  <li><a href="practica_8-3.html">Pr&agrave;c. 8</a></li>  <li><a href="practica_9-2.html">Pr&agrave;c. 9</a></li>  <li><a href="practica_10.html">Pr&agrave;c. 10</a></li></ul></div></div>


  <div class="page">

    <!-- ......... wikipage start ......... -->

<h1><a name="les_hores" id="les_hores">Les hores</a></h1>
<div class="level1">

<p>

<strong>Presentació gràfica de l&#039;activitat.</strong><br/>

<img src="png/rellotge.png" class="media" alt="" />
</p>

<p>
<strong>Funcions que es fan servir en aquesta activitat</strong><br/>

</p>
<ul>
<li class="level1"><div class="li"><a href="funcions.html#aleatentre" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=ALEATENTRE</a><br/>
</div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#si" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=SI()</a><br/>
</div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#consulta" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=CONSULTA()</a><br/>
</div>
</li>
<li class="level1"><div class="li">Operadors de comparació: &lt;, =, &gt;	</div>
</li>
</ul>

<p>
<br/>

<strong>Objectiu de l&#039;activitat</strong><br/>

Escriure les hores amb lletra.<br/>

<br/>

<strong>Desenvolupament de l&#039;activitat</strong><br/>

<strong>1</strong>. Obrir el fitxer <strong>M6</strong> i canviar el nom de <strong>Full3</strong> pel de <strong>M6P2 suport hora</strong>.<br/>

<strong>2</strong>. Escriure a les cel·les del rang <strong>B7:F18</strong> d&#039;aquest nou full, el següent:
<a href="csv/suport_hores.csv" class="media mediafile mf_" title="cursos:tic:d228:modul_6:suport_hores.csv">Llista de les hores.</a>
<img src="png/m5p2_hores.png" class="media" alt="" /><br/>

</p>

<p>
<div class="noteclassic">Aquest full servirà de suport per poder fer l&#039;activitat en un nou full anomenat <strong>M6P2 les hores</strong>.

</div>
<strong>3</strong>. Inserir un nou full amb el nom de <strong>M6P2 les hores</strong><br/>

<br/>

<div class="notewarning"> El que ve a continuació s&#039;escriu al full <strong>M6P2 suport hora</strong>
</div>
<br/>

<strong>4</strong>. Escriure a la cel·la <strong>A1</strong>: <strong>=&#039;M6P2 les hores&#039;.A1</strong><br/>

<div class="noteclassic">El valor d&#039;aquesta cel·la <strong>A1</strong> fa referència a la cel·la <strong>A1</strong> del full <strong>M6P2 les hores</strong>.
</div><br/>

<strong>5</strong>. Escriure a la cel·la <strong>C6</strong>: <strong>=SI(A1=0;ALEATENTRE(1;12))</strong><br/>

<div class="noteclassic">Amb aquesta fórmula s&#039;obté un número aleatori entre <strong>1</strong> i <strong>12</strong> que representarà l&#039;hora.
</div><br/>

<strong>6</strong>. Escriure a la cel·la <strong>D6</strong> els dos punts de l&#039;hora (:)<br/>

<strong>7</strong>. Escriure a la cel·la <strong>E6</strong>: <strong>=CONSULTA(SI(&#039;M6P2 les hores&#039;.A1=0;ALEATENTRE(1;12));C7:C18;E7:E18)</strong><br/>

<div class="noteclassic">Amb aquesta fórmula es fa una consulta aleatòria del minuts <strong>E7:E18</strong> si <strong> &#039;M6P2A hora&#039;.A1</strong> és igual a <strong>0</strong>.El criteri de cerca d&#039;aquest consulta és ALEATENTRE(1;12) fent referència al Vector de cerca
<strong>C7:C18</strong> per a finalment donar una resultat (result_vector) en la corresponent cel·la del rang <strong>E7:E18</strong>.
</div><br/>

Havent obtés el número corresponent a l&#039;hora (<strong>C6</strong>) i el número corresponent als minuts (<strong>E6</strong>), caldrà fer el següent:<br/>

<strong>8</strong>. Escriure a la cel·la <strong>D1</strong>:<br/>

 <strong>=SI(E6&lt;=10;CONSULTA(C6;C7:C18;B7:B18)&amp;&quot; &quot;&amp;CONSULTA(E6;E7:E9;F7:F9);&quot;&quot;)</strong><br/>

<div class="noteclassic">Amb aquesta fórmula s&#039;escriu l&#039;hora i els minuts si el valor de la cel·la <strong>E6</strong> és menor o igual que <strong>10</strong>.Observar que en la segona consulta el vector de cerca de la segona consulta només fa referència al rang <strong>E7:E9</strong>que són justament els valor menors o igual a <strong>10</strong>.<br/>


</div><br/>

<strong>9</strong>. Escriure a la cel·la <strong>D2</strong>:<br/>

<strong>=SI(I(E6&gt;=15;E6&lt;30);CONSULTA(E6;E10:E13;F10:F13)&amp;&quot; &quot;&amp;CONSULTA(C6+1;C7:C19;D7:D19);&quot;&quot;)</strong><br/>

<div class="noteclassic">Aquesta fórmula segueix un procediment semblant a la fórmula anterior però amb la condició de que
la cel·la <strong>E</strong>6 sigui major o igual a <strong>15</strong> i que la cel·la <strong>E6</strong> sigui menor que <strong>30</strong>. Observar que el criteri de cerca de la segona consulta és <strong>C6+1</strong>. D&#039;aquesta manera s&#039;augmenta en una unitat l&#039;aleatori i així, per exemple, les <strong>6:20</strong> hores es pot interpretar com un quart i cinc de set (<strong>C6=6+1=7</strong>).
</div><br/>

<strong>10</strong>. Escriure a la cel·la <strong>D3</strong>:<br/>

<strong>=SI(I(E6&gt;=30;E6&lt;45);CONSULTA(E6;E13:E15;F13:F15)&amp;&quot; &quot;&amp;CONSULTA(C6+1;C7:C19;D7:D19);&quot;&quot;)</strong><br/>

<div class="noteclassic">Aquesta fórmula és pràcticament una copia de l&#039;anterior on només canvien els valors de la cel·la <strong>E6</strong> i dels vectors de cerca i de resul_vector.
</div><br/>

<strong>11</strong>. Escriure a la cel·la <strong>D4</strong>:<br/>

<strong>=SI(E6&gt;=45;CONSULTA(E6;E16:E18;F16:F18)&amp;&quot; &quot;&amp;CONSULTA(C6+1;C7:C19;D7:D19);&quot;&quot;)</strong><br/>

<div class="noteclassic">En aquesta fórmula la condició  és que el valor de la cel·la <strong>E6</strong> sigui major o igual que <strong>45</strong>.
</div>
<strong>12</strong>. Escriure a la cel·la <strong>D5</strong>: <strong>=D1&amp;D2&amp;D3&amp;D4</strong><br/>

<div class="noteclassic">Aquesta fórmula concatena les cel·les del rang <strong>D1:D4</strong> obtenint l&#039;hora amb lletra.
</div><br/>

<div class="noteclassic">
Amb els passos <strong>9</strong>, <strong>10</strong>, <strong>11</strong> i <strong>12</strong> és una manera de fer l&#039;exercici. Una altra manera de fer el mateix, sene haver d&#039;escriure aquests passos, seria escrivin a cel·la <strong>D5</strong> el següent:<br/>

<strong>=SI(E6&lt;=10;CONSULTA(C6;C7:C18;B7:B18)&amp;&quot; &quot;&amp;CONSULTA(E6;E7:E18;F7:F18);CONSULTA(E6;E7:E18;F7:F18)&amp;&quot; &quot;&amp;CONSULTA(C6+1;C7:C18;D7:D18))</strong>

</div><br/>

<br/>

<div class="notewarning">El que ve a continuació s&#039;escriu al full <strong>M6P2 les hores</strong>
</div>
<br/>

<strong>13</strong>. Formatar les cel·les del rang <strong>F5:G8</strong> com es veu en el gràfic de la presentació de l&#039;activitat.<br/>

<strong>14</strong>. Escriure a la ce·la <strong>B5</strong>: <strong>=&#039;M6P2 suport hora&#039;.C6</strong><br/>

<strong>15</strong>. Fer una copia de la cel·la <strong>B5</strong> i enganxar-ho a les cel·les <strong>C5</strong> i <strong>D5</strong><br/>

<strong>16</strong>. Escriure a la cel·la <strong>G5</strong>: <strong>=SI(F5=&quot;&quot;;&quot;&quot;;SI(F5=&#039;M6P2 suport hora&#039;.D5;&quot;bé&quot;;&quot;no&quot;))</strong><br/>

<strong>17</strong>. Fer una macro amb les següent funcions:<br/>

</p>
<ul>
<li class="level1"><div class="li">Esborrar el valor de la cel·la <strong>F5</strong></div>
</li>
<li class="level1"><div class="li">Assignar a la cel·la <strong>A1</strong> el valor de <strong>0</strong></div>
</li>
<li class="level1"><div class="li">Que la cel·la <strong>F5</strong> rebi el focus.</div>
</li>
</ul>

<p>
<strong>18</strong>. Crear un botó de prémer de Controls de formulari i assignar-li la macro feta anteriorment.<br/>

<strong>19</strong>. Validar la cel·la A1 per al valor 0.<br/>

<strong>20</strong>. Protegir les cel·les que convingui.<br/>

<strong>21</strong>. Ocultar o fer no visible les cel·les que convingui.<br/>

<strong>22</strong>. Comprovar que l&#039;activitat funcioni correctament.<br/>

<strong>23</strong>. Desar el fitxer <strong>M6</strong><br/>

<div class="noteclassic">A vegades les hores es diuen de diferent manera segons el lloc on es viu. Per exemple, <em class="u">dos quarts de dues</em> per <em class="u">la una i mitja</em>. Sent així, convindria fer un exemple d&#039;escriure una determinada hora per donar referència de quina manera s&#039;espera que s&#039;escrigui l&#039;hora.<br/>

També convindria fer un exemple per donar referència de quina manera s&#039;escriu l&#039;hora en quant a:<br/>

</p>
<ul>
<li class="level1"><div class="li">Escriure o no la primera lletra en majúscula.</div>
</li>
<li class="level1"><div class="li">Escriure o no el punt final de l&#039;escrit.</div>
</li>
</ul>

<p>
Aquests detalls són importants perquè es podria donar el cas d&#039;escriure bé l&#039;hora i la cel·la avaluadora no ho donés per bo.
</div>
</p>

</div>

<h1><a name="activitat_relacionada_amb_la_comptabilitat" id="activitat_relacionada_amb_la_comptabilitat">Activitat relacionada amb la comptabilitat</a></h1>
<div class="level1">

<p>
<strong>Presentació gràfica de l&#039;activitat</strong><br/>

<img src="png/comptabilitat.png" class="media" alt="" /><br/>

<br/>

<strong>Funcions que es fan servir en aquesta activitat</strong><br/>

</p>
<ul>
<li class="level1"><div class="li"><a href="funcions.html#si" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=SI()</a><br/>
</div>
</li>
<li class="level1"><div class="li"><a href="funcions.html#suma" class="wikilink1" title="cursos:tic:d228:g_rapida:funcions">=SUMA()</a><br/>
</div>
</li>
<li class="level1"><div class="li">Operadors de suma (+) i resta (-)	</div>
</li>
</ul>

<p>
<br/>

<strong>Objectiu de l&#039;activitat</strong><br/>

Fer una senzilla comptabilitat domèstica.<br/>

<br/>

<strong>Desenvolupament de l&#039;activitat</strong><br/>

<strong>1</strong>. Obrir el el fitxer <strong>M6</strong> i afegir un nou full anomenat <strong>M6P2 comptabilitat</strong>.<br/>

<strong>2</strong>. Escriure a les cel·les del rang <strong>B2:E21</strong> el que es veu en les del cel·les del rang <strong>B2:E21</strong> del gràfic de la presentació de l&#039;activitat.<br/>

<a href="csv/llista_comptabilitat.csv" class="media mediafile mf_" title="cursos:tic:d228:modul_6:llista_comptabilitat.csv">Llista comptabilitat</a><br/>

<strong>3</strong>. Fer que el rang <strong>B2:F21</strong> tingui un format (atributs de la cel·la) semblant al gràfic de la presentació de l&#039;activitat.<br/>

<strong>4</strong>. Escriure a la cel·la <strong>F4</strong>: <strong>=D2+D4-E4</strong> (es suma el <strong>saldo inicial</strong> més l&#039;ingrés de la <strong>nòmina1</strong> menys la despesa de la cel·la <strong>E4</strong>)<br/>

<strong>5</strong>. Escriure a la cel·la <strong>F5</strong>: <strong>=SI(I(D5=&quot;&quot;;E5=&quot;&quot;);&quot;&quot;;F4+D5-E5)</strong> (si les cel·les <strong>D5</strong> i <strong>E5</strong> no contenen res, llavors la cel·la <strong>F5</strong> no mostra res; si no, es suma el valor de la cel·la <strong>F4</strong> més el valor de la cel·la <strong>D5</strong> menys el valor de la cel·la <strong>E5</strong>)<br/>

<strong>6</strong>. Copiar el contingut de la cel·la <strong>F5</strong> a les cel·les del rang <strong>F6:F21</strong><br/>

<strong>7</strong>. Seleccionar les cel·les del rang <strong>B3:F21</strong> i anar a <strong>Dades | Filtre| i clic en Filtre automàtic</strong>.<br/>

<div class="noteclassic">És probable que en fer el pas <strong>7</strong> es mostri el següent missatge: <em class="u">“L&#039;interval no conté les capçaleres de les columnes. Voleu utilitzar la primera línia com a capçalera de la columna?”</em> Llavors fer clic en <strong>Si</strong>

</div>
<strong>8</strong>. Comprovar que funcionin bé els filtres fent un filtre de la paraula <strong>alimentació</strong> de la columna que té per capçalera la paraula <strong>concepte</strong> (<strong>cel·la C3</strong>). Havent fet el filtre, només s&#039;haurien de mostrar quatre files fent referència a la paraula <strong>alimentació</strong>.<br/>

<strong>9</strong>. Escriure a les cel·les del rang <strong>H4:H9</strong> el que hi ha escrit al gràfic de presentació de l&#039;activitat.<br/>

<strong>10</strong>. Escriure a la cel·la<strong> I4</strong>:<strong>=SUMA(D4:D21)</strong><br/>

<strong>11</strong>. Escriure a la cel·la <strong>I5</strong>: <strong>=SUMA(E4:E21)</strong><br/>

<strong>12</strong>. Escriure a la cel·la <strong>I6</strong>: <strong>=I4-I5+D2</strong><br/>

<div class="noteclassic">Per saber la despesa acumulada per concepte, primer caldrà fer una selecció d&#039;aquelles cel·les del rang <strong>C4:C21</strong> que cotinguin el valor de la cel·la <strong>H9</strong>. Es per això, que a la cel·la <strong>J4</strong> s&#039;escriu <strong>=SI(C4=$H$9;E4;&quot;&quot;)</strong>. És a dir, si el valor la cel·la <strong>C4</strong> és igual al valor de la cel·la <strong>H9</strong>, llavors es mostra el valor de la cel·la <strong>E4</strong>; si no, no es mostra res.
</div><br/>

<strong>13</strong>. Escriure a la cel <strong>J4</strong>:<strong>=SI(C4=$H$9;E4;&quot;&quot;)</strong><br/>

<strong>14</strong>. Copiar la cel·la <strong>J4</strong> i enganxar-la a les cel·les del rang <strong>J5:J21</strong>.<br/>

<div class="noteclassic">Ara només cal sumar les cel·les del rang <strong>J5:J21</strong> per saber la despesa acumulada en funció del que hi ha escrit a la cel·la <strong>H9</strong>.
</div><br/>

<strong>15</strong>. Escriure a la cel·la <strong>I9</strong>: <strong>=SUMA(J4:J21)</strong><br/>

<strong>16</strong>. Protegir les cel·les que convingui.<br/>

<strong>17</strong>. Ocultar les cel·les que convingui.<br/>

<strong>18</strong>. Comprovar que funcioni correctament l&#039;activitat.<br/>

<strong>19</strong>. Desar el fitxer <strong>M6</strong>.<br/>


</p>

</div>

    <!-- ......... wikipage stop  ......... -->

  </div>

  <div class="clearer">&nbsp;</div>


<br /><br />

 <div class="footerinc">
  <hr />
  <table style="width: 100%;">
  <tr style="vertical-align: middle;">
    <td  style="width: 18%; ">
      <div style="float: left;">
      <!--<a target="_blank" href="http://ateneu.xtec.cat/wikiform" title="Materials i recursos per a la formació"><img src="png/ateneu2.png" width="91" height="30" alt="Materials i recursos per a la formació" /></a>-->
      </div>
    </td>
    <td style="width: 32%;">

    </td>
    <td style="width: 32%;">

      <!--      <a target="_blank"href="http://www.dokuwiki.org/" target="_blank" title="DokuWiki"><img src="png/button-dw.png" width="80" height="15" alt="DokuWiki" /></a>-->

    </td>
	<td style="width: 18%;">
      <div style="float: right;">

      </div>
    </td>
  </tr>
  </table>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>
-->
</div>

</div>

</body>

<!-- Generat el 28/Mar/2012  14:47:27  amb HTTrack -->
</html>
